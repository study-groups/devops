{
  "metadata": {
    "title": "TUT Reference",
    "tagline": "Data-Driven Documentation Generator",
    "description": "Complete reference for the TUT documentation system",
    "version": "1.1.0",
    "author": "tetra"
  },
  "groups": [
    {
      "id": "overview",
      "title": "Overview",
      "topics": [
        {
          "id": "what-is-tut",
          "title": "What is TUT?",
          "description": "TUT is a data-driven documentation generator that converts JSON definitions into HTML documentation. It supports two document types: guides (step-by-step tutorials) and reference docs (scrollable topic-based documentation).",
          "content": [
            {
              "type": "module-grid",
              "modules": [
                { "name": "Guide", "description": "Step-by-step interactive tutorials with terminal simulation" },
                { "name": "Reference", "description": "Scrollable topic-based docs with sidebar navigation" }
              ]
            }
          ]
        },
        {
          "id": "quick-start",
          "title": "Quick Start",
          "description": "Get started generating documentation in seconds.",
          "content": [
            {
              "type": "code-block",
              "code": "# List available sources\ntut get sources\n\n# Build a document\ntut build my-ref\n\n# Generate landing page\ntut index\n\n# Preview in browser\ntut serve"
            }
          ]
        },
        {
          "id": "environment",
          "title": "Environment",
          "description": "TUT uses two environment variables for paths.",
          "content": [
            {
              "type": "table",
              "headers": ["Variable", "Purpose", "Example"],
              "rows": [
                ["TUT_SRC", "Source files (JSON, templates)", "$TETRA_SRC/bash/tut"],
                ["TUT_DIR", "Output directory", "$TETRA_DIR/tut"]
              ]
            },
            {
              "type": "paragraph",
              "text": "Run tut doctor to verify your environment is configured correctly."
            }
          ]
        }
      ]
    },
    {
      "id": "cli",
      "title": "CLI Commands",
      "topics": [
        {
          "id": "tut-build",
          "title": "tut build",
          "description": "Build documentation from JSON source files.",
          "content": [
            {
              "type": "api-function",
              "name": "tut build",
              "signature": "tut build <name> [--type guide|reference] [--no-bump] [--all]",
              "summary": "Builds HTML documentation from a JSON source file. Type is auto-detected from JSON structure.",
              "parameters": [
                { "name": "name", "type": "string", "description": "Source name (without .json extension)" },
                { "name": "--type", "type": "string", "description": "Force document type (guide or reference)" },
                { "name": "--no-bump", "type": "flag", "description": "Skip version bump prompt" },
                { "name": "--all", "type": "flag", "description": "Build all sources in available/" }
              ],
              "returns": {
                "type": "file",
                "description": "Generated HTML in $TUT_DIR/generated/"
              },
              "example": "tut build nh-ref --no-bump"
            }
          ]
        },
        {
          "id": "tut-init",
          "title": "tut init",
          "description": "Create a new document from template.",
          "content": [
            {
              "type": "api-function",
              "name": "tut init",
              "signature": "tut init <name> [--type guide|reference]",
              "summary": "Creates a new JSON template in the available/ directory.",
              "parameters": [
                { "name": "name", "type": "string", "description": "Document name (becomes filename)" },
                { "name": "--type", "type": "string", "default": "reference", "description": "Document type" }
              ],
              "example": "tut init my-project-ref --type reference"
            }
          ]
        },
        {
          "id": "tut-serve",
          "title": "tut serve",
          "description": "Start a local server and preview documentation.",
          "content": [
            {
              "type": "api-function",
              "name": "tut serve",
              "signature": "tut serve [file] [--port N] [--stop] [--status]",
              "summary": "Starts an HTTP server via TSM and opens the browser. Uses the tut service for process management.",
              "parameters": [
                { "name": "file", "type": "string", "description": "Specific file to open in browser" },
                { "name": "--port", "type": "number", "description": "Server port (default: auto-assigned)" },
                { "name": "--stop", "type": "flag", "description": "Stop the server" },
                { "name": "--status", "type": "flag", "description": "Show server status" }
              ],
              "example": "tut serve tut-reference.html"
            }
          ]
        },
        {
          "id": "tut-index",
          "title": "tut index",
          "description": "Generate a landing page for all documents.",
          "content": [
            {
              "type": "api-function",
              "name": "tut index",
              "signature": "tut index",
              "summary": "Scans $TUT_DIR/generated/ for HTML files and creates an index.html landing page with cards linking to each document.",
              "example": "tut index"
            },
            {
              "type": "paragraph",
              "text": "The index page extracts metadata (title, version, type) from each document's meta tags and displays them in a card grid."
            }
          ]
        },
        {
          "id": "tut-get",
          "title": "tut get",
          "description": "Query sources and generated documents.",
          "content": [
            {
              "type": "command-list",
              "commands": [
                { "code": "tut get sources", "description": "List JSON files in available/" },
                { "code": "tut get docs", "description": "List generated HTML files with metadata" },
                { "code": "tut get recordings", "description": "List terminal recordings (.cast files)" }
              ]
            }
          ]
        },
        {
          "id": "tut-other",
          "title": "Other Commands",
          "content": [
            {
              "type": "command-list",
              "commands": [
                { "code": "tut validate <name>", "description": "Validate JSON against schema" },
                { "code": "tut doctor", "description": "Check environment and paths" },
                { "code": "tut types", "description": "Overview of document types" },
                { "code": "tut types guide", "description": "Guide schema and structure" },
                { "code": "tut types reference", "description": "Reference schema and structure" },
                { "code": "tut help", "description": "Show help" }
              ]
            }
          ]
        }
      ]
    },
    {
      "id": "content-types",
      "title": "Content Types",
      "topics": [
        {
          "id": "paragraph",
          "title": "paragraph",
          "description": "Simple text block.",
          "content": [
            {
              "type": "code-block",
              "language": "json",
              "code": "{\n  \"type\": \"paragraph\",\n  \"text\": \"Your text content here.\"\n}"
            }
          ]
        },
        {
          "id": "command-list",
          "title": "command-list",
          "description": "List of commands with descriptions. Ideal for CLI reference.",
          "content": [
            {
              "type": "code-block",
              "language": "json",
              "code": "{\n  \"type\": \"command-list\",\n  \"commands\": [\n    { \"code\": \"cmd arg\", \"description\": \"What it does\" },\n    { \"code\": \"cmd --flag\", \"description\": \"Another command\" }\n  ]\n}"
            },
            {
              "type": "paragraph",
              "text": "Renders as:"
            },
            {
              "type": "command-list",
              "commands": [
                { "code": "cmd arg", "description": "What it does" },
                { "code": "cmd --flag", "description": "Another command" }
              ]
            }
          ]
        },
        {
          "id": "code-block",
          "title": "code-block",
          "description": "Fenced code with optional language. Click-to-copy is automatic.",
          "content": [
            {
              "type": "code-block",
              "language": "json",
              "code": "{\n  \"type\": \"code-block\",\n  \"language\": \"bash\",\n  \"code\": \"echo 'Hello World'\"\n}"
            }
          ]
        },
        {
          "id": "module-grid",
          "title": "module-grid",
          "description": "Grid of cards for displaying modules, features, or options.",
          "content": [
            {
              "type": "code-block",
              "language": "json",
              "code": "{\n  \"type\": \"module-grid\",\n  \"modules\": [\n    { \"name\": \"Module A\", \"description\": \"Does X\" },\n    { \"name\": \"Module B\", \"description\": \"Does Y\" }\n  ]\n}"
            },
            {
              "type": "paragraph",
              "text": "Renders as:"
            },
            {
              "type": "module-grid",
              "modules": [
                { "name": "Module A", "description": "Does X" },
                { "name": "Module B", "description": "Does Y" }
              ]
            }
          ]
        },
        {
          "id": "list",
          "title": "list",
          "description": "Ordered or unordered list.",
          "content": [
            {
              "type": "code-block",
              "language": "json",
              "code": "{\n  \"type\": \"list\",\n  \"ordered\": false,\n  \"items\": [\"First item\", \"Second item\", \"Third item\"]\n}"
            }
          ]
        },
        {
          "id": "table",
          "title": "table",
          "description": "Data table with headers and rows.",
          "content": [
            {
              "type": "code-block",
              "language": "json",
              "code": "{\n  \"type\": \"table\",\n  \"headers\": [\"Name\", \"Type\", \"Description\"],\n  \"rows\": [\n    [\"id\", \"string\", \"Unique identifier\"],\n    [\"title\", \"string\", \"Display title\"]\n  ]\n}"
            },
            {
              "type": "paragraph",
              "text": "Renders as:"
            },
            {
              "type": "table",
              "headers": ["Name", "Type", "Description"],
              "rows": [
                ["id", "string", "Unique identifier"],
                ["title", "string", "Display title"]
              ]
            }
          ]
        }
      ]
    },
    {
      "id": "api-types",
      "title": "API Content Types",
      "topics": [
        {
          "id": "api-endpoint",
          "title": "api-endpoint",
          "description": "REST API endpoint documentation with method, path, parameters, and responses.",
          "content": [
            {
              "type": "api-endpoint",
              "method": "POST",
              "path": "/api/users",
              "summary": "Create a new user account",
              "parameters": [
                { "name": "email", "type": "string", "required": true, "description": "User email address" },
                { "name": "name", "type": "string", "required": true, "description": "Display name" }
              ],
              "requestBody": {
                "contentType": "application/json",
                "example": "{\n  \"email\": \"user@example.com\",\n  \"name\": \"John Doe\"\n}"
              },
              "responses": [
                { "status": 201, "description": "User created successfully" },
                { "status": 400, "description": "Invalid request body" }
              ]
            }
          ]
        },
        {
          "id": "api-function",
          "title": "api-function",
          "description": "Function/method documentation with signature, parameters, returns, and example.",
          "content": [
            {
              "type": "api-function",
              "name": "_tut_build",
              "signature": "_tut_build <name> [--type] [--no-bump]",
              "summary": "Internal function that builds a single document.",
              "parameters": [
                { "name": "name", "type": "string", "description": "Source file name" },
                { "name": "--type", "type": "string", "description": "Force guide or reference" },
                { "name": "--no-bump", "type": "flag", "description": "Skip version prompt" }
              ],
              "returns": { "type": "file", "description": "HTML file in generated/" },
              "example": "_tut_build nh-ref --no-bump"
            }
          ]
        }
      ]
    },
    {
      "id": "structure",
      "title": "Document Structure",
      "topics": [
        {
          "id": "reference-structure",
          "title": "Reference Structure",
          "description": "Reference documents are organized into groups containing topics.",
          "content": [
            {
              "type": "code-block",
              "language": "json",
              "code": "{\n  \"metadata\": {\n    \"title\": \"My Docs\",\n    \"tagline\": \"Optional subtitle\",\n    \"version\": \"1.0.0\"\n  },\n  \"groups\": [\n    {\n      \"id\": \"getting-started\",\n      \"title\": \"Getting Started\",\n      \"topics\": [\n        {\n          \"id\": \"install\",\n          \"title\": \"Installation\",\n          \"description\": \"How to install...\",\n          \"content\": [ ... ]\n        }\n      ]\n    }\n  ]\n}"
            }
          ]
        },
        {
          "id": "guide-structure",
          "title": "Guide Structure",
          "description": "Guides are linear step-by-step tutorials with terminal simulation.",
          "content": [
            {
              "type": "code-block",
              "language": "json",
              "code": "{\n  \"metadata\": {\n    \"title\": \"My Guide\",\n    \"difficulty\": \"beginner\",\n    \"estimatedTime\": 15\n  },\n  \"steps\": [\n    {\n      \"id\": \"step-1\",\n      \"title\": \"Step 1\",\n      \"content\": [ ... ],\n      \"terminal\": [\n        { \"type\": \"prompt\", \"content\": \"$ \" },\n        { \"type\": \"command\", \"content\": \"echo hello\" },\n        { \"type\": \"output\", \"content\": \"hello\" }\n      ]\n    }\n  ]\n}"
            }
          ]
        },
        {
          "id": "file-organization",
          "title": "File Organization",
          "content": [
            {
              "type": "table",
              "headers": ["Path", "Purpose"],
              "rows": [
                ["$TUT_SRC/tut.sh", "Main CLI entry point"],
                ["$TUT_SRC/includes.sh", "Module loader"],
                ["$TUT_SRC/tut_reference.sh", "Reference doc renderer"],
                ["$TUT_SRC/tut_complete.sh", "Tab completion"],
                ["$TUT_SRC/core/output.sh", "Output helpers (colors, formatting)"],
                ["$TUT_SRC/core/validators.sh", "JSON validation"],
                ["$TUT_SRC/renderers/html.sh", "Guide HTML renderer"],
                ["$TUT_SRC/templates/", "HTML/CSS/JS templates"],
                ["$TUT_SRC/available/", "Source JSON files"],
                ["$TUT_DIR/generated/", "Output HTML files"]
              ]
            }
          ]
        }
      ]
    },
    {
      "id": "theming",
      "title": "Theming",
      "collapsed": true,
      "topics": [
        {
          "id": "design-tokens",
          "title": "Design Tokens",
          "description": "TUT uses CSS custom properties for theming. Access the design token editor by adding ?design=true to any document URL.",
          "content": [
            {
              "type": "table",
              "headers": ["Token", "Default", "Purpose"],
              "rows": [
                ["--bg-primary", "#1a1a2e", "Page background"],
                ["--bg-secondary", "#16213e", "Sections, sidebar"],
                ["--bg-tertiary", "#0d1b2a", "Code blocks, cards"],
                ["--text-title", "#eaeaea", "Titles, headings"],
                ["--text-primary", "#c0c0d0", "Body text"],
                ["--text-secondary", "#8a8aa0", "Muted text"],
                ["--text-code", "#ff6b6b", "Code block text"],
                ["--accent-primary", "#e94560", "Links, highlights"],
                ["--border", "#2a2a4a", "Borders, dividers"]
              ]
            }
          ]
        },
        {
          "id": "design-editor",
          "title": "Design Token Editor",
          "description": "The FAB (Floating Action Button) provides real-time theme editing.",
          "content": [
            {
              "type": "list",
              "ordered": false,
              "items": [
                "Add ?design=true to any document URL to enable",
                "Click the FAB to open the design panel",
                "Edit colors, fonts, and section styles",
                "Export theme as tokens.json file",
                "Import themes from file or localStorage",
                "Copy CSS variables to clipboard"
              ]
            },
            {
              "type": "paragraph",
              "text": "Themes are saved to localStorage and persist across sessions."
            }
          ]
        },
        {
          "id": "google-fonts",
          "title": "Google Fonts",
          "description": "Add custom fonts by pasting the Google Fonts embed code.",
          "content": [
            {
              "type": "list",
              "ordered": true,
              "items": [
                "Go to fonts.google.com and select fonts",
                "Click 'Get embed code'",
                "Paste the full embed code into the font input",
                "Multi-font suites are supported",
                "Mono fonts auto-assign to Code, sans fonts to Heading/Body"
              ]
            }
          ]
        }
      ]
    }
  ]
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1">
    <title>DevPages</title>
    <link rel="stylesheet" href="/client/output.css">
    <!-- Add Log component specific styles -->
    <link rel="stylesheet" href="/client/log/log.css"> 
    <link rel="stylesheet" href="/client/components/auth-display.css">
    <link rel="stylesheet" href="/client/components/context-manager.css">
    <!-- Settings Panel Styles -->
    <link rel="stylesheet" href="/client/settings/settings.css">
    <!-- Code Sidebar Styles -->
    <link rel="stylesheet" href="/client/code/code-sidebar.css">
    <!-- File List Component Styles -->
    <link rel="stylesheet" href="/client/code/file-list.css">
    <!-- Include KaTeX CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css">
    
    <!-- Synchronous script to set initial state from localStorage -->
    <script src="/client/earlyInit.js"></script> 
    
    <!-- Core scripts -->
    <script src="/client/errorTracker.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script src="/client/code/ast-parser.js"></script>

    <!-- START: Add this CSS block for testing -->
    <style>
        #context-settings-trigger {
            cursor: pointer !important; /* Forcing it for the test */
            user-select: none;         /* Disable text selection */
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none;    /* Firefox */
            -ms-user-select: none;     /* IE/Edge */
            display: inline-block;     /* Helps it behave more like an element */
            /* If this element had other classes like 'breadcrumb-separator',
               and those classes define padding/margin you want to keep,
               you might need to re-apply them or ensure this styling is compatible.
               For now, focusing on cursor and selection. */
        }

        /* Optional: if you want a visual cue on hover beyond the cursor */
        /*
        #context-settings-trigger:hover {
            opacity: 0.7; // Or any other visual feedback
        }
        */
    </style>
    <!-- END: Add this CSS block for testing -->
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="top-bar top-bar-full">

        <!-- Left: Context Selector -->
        <div id="context-manager-container" class="nav-group context-selector">
             <!-- ContextManagerComponent will render here -->
        </div>

        <!-- Middle: View controls with consistent styling -->
        <!-- Middle: View Controls (May need adjustment for mobile) -->
        <div id="view-controls-container" class="nav-group view-controls">
             <!-- Buttons will be rendered here by ViewControlsComponent -->
        </div>

        <!-- Right side: Auth controls & Version -->
        <div class="nav-group right-group">
            <!-- Version Number -->            <!-- Auth Info -->
            <div id="auth-component-container" class="auth-info">
                <!-- This div will be populated by the AuthDisplay component -->
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <div style="display: flex; height: calc(100vh - 40px);"> <!-- Assuming top-bar is 40px -->
        <!-- Left Sidebar - Only visible in Code mode -->
        <div id="code-sidebar" class="code-mode-only" style="width: 250px; background-color: #f8f9fa; border-right: 1px solid #ddd; overflow-y: auto;">
            <div id="code-sidebar-content">
                <!-- File list will be populated here by FileListComponent -->
            </div>
        </div>

        <!-- Original Main Content (acts as Center Panel) -->
        <div id="main-container" class="log-hidden" style="flex-grow: 1; display: flex; flex-direction: column;">
            <div id="content" style="flex-grow: 1; overflow-y: auto;">
                <!-- This div will be populated by the ContentView component -->
                <div id="content-view-wrapper"></div>
            </div>
            <div id="log-container"></div>
        </div>

        <!-- NEW: RIGHT SIDEBAR - Context Summary + CLI Output -->
        <div id="right-sidebar" class="code-sidebar" style="width: 320px; background-color: #f8f9fa; border-left: 1px solid #ddd; overflow-y: auto; display: flex; flex-direction: column;">
            
            <!-- Context Summary Section -->
            <div id="context-summary-section" style="flex: 1; min-height: 250px;">
                <div id="context-summary-header" style="padding: 6px 8px; background-color: #f1f3f5; border-bottom: 1px solid #dee2e6;">
                    <span style="font-size: 11px; color: #6c757d; font-weight: 500;">CONTEXT</span>
                </div>
                <div id="context-summary-content" style="padding: 8px;">
                    <div id="context-items" style="display: flex; flex-direction: column; gap: 4px;">
                        <!-- Context items will be populated here -->
                        <div style="font-size: 11px; color: #6c757d; font-style: italic;">No items selected for context</div>
                    </div>
                </div>
            </div>
            
            <!-- CLI Output Section -->
            <div id="cli-output-section" style="flex: 1; min-height: 200px; border-top: 1px solid #dee2e6;">
                <div id="cli-output-header" style="padding: 6px 8px; background-color: #f1f3f5; border-bottom: 1px solid #dee2e6;">
                    <span style="font-size: 11px; color: #6c757d; font-weight: 500;">CLI OUTPUT</span>
                    <button id="context-send-to-llm" style="float: right; padding: 2px 6px; background: #28a745; color: white; border: none; border-radius: 3px; font-size: 10px; cursor: pointer;">SEND TO LLM</button>
                </div>
                <div id="cli-output-content" style="padding: 8px; font-family: monospace; font-size: 11px; color: #495057; overflow-y: auto; max-height: 300px;">
                    <div style="color: #6c757d; font-style: italic;">CLI output will appear here</div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="toolbar-container" class="editor-toolbar"></div>

    <!-- Main application module loader -->
    <script type="module" src="/client/bootstrap.js"></script>
    
    <!-- Code Analysis Components -->
    <script src="/client/code/code-manager.js"></script>
    <!-- FileListComponent is now imported by enhancedSidebars.js, so this direct load might be redundant if not used elsewhere -->
    <!-- <script type="module" src="/client/code/file-list-component.js"></script> --> 
    
    <!-- Load the new external script for sidebars -->
    <script type="module" src="/client/enhancedSidebars.js"></script>

    <script>
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = '/client/components/auth-display.css';
        document.head.appendChild(link);
    </script>
</body>


</html>